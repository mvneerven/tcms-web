<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>gh3</title>

</head>

<body>
    <ul id="user"></ul>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.9.1/underscore-min.js"></script>
    <script src="js/gh3.js"></script>

    <script>

        var user = new Gh3.User("mvneerven")
            

        var wiki = new Gh3.Repository("isvcanvas-help.wiki.git", user);


        wiki.fetch(function (err, res) {

            if (err) { throw "outch ..." }

            wiki.fetchBranches(function (err, res) {
                if (err) { throw "outch ..." }

                var master = wiki.getBranchByName("master");
                debugger;

                //branchTitle.html(master.name + " (" + master.sha + ") :");

                master.fetchContents(function (err, res) {
                    if (err) { throw "outch ..." }

                    master.eachContent(function (content) {
                        console.log('<li>' + content.name + " : " + content.type);

                    });

                    //var myfile = master.getContents()[8];

                    var myfile = master.getFileByName("wiki.git/Test-page");

                    console.log("index.html", myfile);

                    myfile.fetchContent(function (err, res) {
                        if (err) { throw "outch ..." }

                        rawContent.text(myfile.getRawContent());
                    });

                    myfile.fetchCommits(function (err, res) {
                        if (err) { throw "outch ..." }

                        console.log(myfile.getCommits());

                        myfile.eachCommit(function (commit) {
                            console.log(commit.author.login, commit.message, commit.date);
                        });
                    });

                });

            })
        });

    </script>

</body>

</html>